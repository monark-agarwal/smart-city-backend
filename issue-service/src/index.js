const express=require('express');const { graphqlHTTP }=require('express-graphql');const schema=require('./graphql/schema');const resolvers=require('./graphql/resolvers');const sequelize=require('./db/connection');const { connectProducer }=require('./kafka/producer');const authMiddleware=require('./middleware/auth');require('dotenv').config();const app=express();app.use('/graphql',authMiddleware(['Citizen','Admin']),graphqlHTTP({schema,rootValue:resolvers,graphiql:true}));(async()=>{await sequelize.sync({alter:true});await connectProducer();app.listen(process.env.PORT||4000,()=>console.log('Issue Service running'))})();
