const { Kafka } = require('kafkajs');require('dotenv').config();const kafka=new Kafka({brokers:[process.env.KAFKA_BROKER]});const consumer=kafka.consumer({groupId:'notification-service'});const run=async()=>{await consumer.connect();await consumer.subscribe({topic:'issue_created'});await consumer.subscribe({topic:'issue_updated'});await consumer.run({eachMessage:async({topic,message})=>{const event=JSON.parse(message.value.toString());console.log('[Notification] Topic:',topic,event);}});};module.exports={run};
